<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIGAgames.com</title>
    <style>
        body {
            margin: 0; /* Убирает отступ по умолчанию, чтобы текст был выше */
            padding-left: 170px;  /* Добавляет отступ слева для баннера */
            padding-right: 170px; /* Добавляет отступ справа для баннера */
        }
        #main-content {
            /* Этот контейнер будет скрыт до входа в систему */
            display: none;
        }
        #auth-container {
            position: absolute;
            top: 10px;
            right: 10px;
            text-align: right;
        }
        #auth-container button {
            margin-left: 5px;
        }
        .button-container {
            text-align: center;
            margin-top: 100px; /* Отодвигает кнопки вниз */
        }
        .button-container button {
            animation: float 12s ease-in-out infinite;
        }
        .button-container button:nth-child(1) {
            animation-delay: 0s;
        }
        .button-container button:nth-child(2) {
            animation-delay: -4s;
        }
        .button-container button:nth-child(3) {
            animation-delay: -8s;
        }
        button {
            padding: 12px 24px;
            font-size: 16px;
            margin: 8px;
            cursor: pointer;
            border: 2px solid black; /* Добавлена жирная черная рамка */
        }
        .game-menu {
            display: none; /* Hidden by default. */
            margin-top: 20px;
            padding: 20px 40px; /* Reduced vertical padding */
            border: 1px solid #ccc;
            text-align: center;
            position: relative; /* Needed for absolute positioning of child elements */
            width: 50%; /* Set a width */
            margin-left: auto; /* Center the block */
            margin-right: auto; /* Center the block */
        }

        .back-button {
            position: absolute;
            top: 10px; /* Adjust as needed for padding */
            left: 10px; /* Adjust as needed for padding */
            background: none; /* Make it look less like a standard button */
            border: none;
            font-size: 24px; /* Make the arrow prominent */
            cursor: pointer;
            padding: 0; /* Remove default button padding */
            margin: 0; /* Remove default button margin */
        }
        .game-menu p {
            font-size: 22px; /* Увеличен размер текста "BOT" и "PLAYER" */
            font-weight: bold;
            margin-top: 0; /* Приближает "BOT" к верху */
            margin-bottom: 15px; /* Стандартный отступ снизу */
        }
        .game-menu button {
            /* Эти стили не будут применяться к кнопке "назад" из-за её более специфичного класса .back-button */
            padding: 10px 20px; /* Уменьшены отступы для кнопок */
            font-size: 16px; /* Уменьшен шрифт на кнопках */
        }
        #result-container {
            height: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        #dice-icon {
            font-size: 100px; /* Сделаем кость крупнее */
            margin: 20px 0;
            text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.3); /* Добавим тень для объема */
            transform: rotate(-8deg); /* Немного наклоним */
            color: #333; /* Сделаем цвет чуть мягче */
        }
        #dice-icon-container {
            height: 140px; /* Задаем фиксированную высоту контейнеру */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .spinning {
            animation: spin 0.4s linear infinite; /* Увеличена скорость вращения */
            text-shadow: none; /* Убираем тень во время вращения для плавности */
        }

        #emoji-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            overflow: hidden;
        }

        #emoji-background span {
            position: absolute;
            user-select: none; /* Запрещает выделение смайликов */
            animation: float 10s ease-in-out infinite;
        }

        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); } /* Начальное положение */
            25% { transform: translateY(-5px) rotate(-5deg); } /* Чуть вверх и влево */
            50% { transform: translateY(-10px) rotate(0deg); } /* Максимально вверх, без наклона */
            75% { transform: translateY(-5px) rotate(5deg); } /* Чуть вверх и вправо */
            100% { transform: translateY(0px) rotate(0deg); } /* Возврат в начальное положение */
        }

        #welcome-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        .auth-form-container {
            background-color: #333;
            padding: 30px;
            border-radius: 10px;
            width: 350px;
            text-align: center;
        }
        .auth-form-container input {
            width: 90%;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
            border: 1px solid #555;
        }
        .auth-switch-link {
            color: #00aaff;
            cursor: pointer;
            font-size: 14px;
            margin-top: 15px;
            display: inline-block;
        }
        .auth-form-container button {
            border: 2px solid black; /* Применяем стиль рамки к кнопкам в форме */
            background-color: #007bff; /* Default blue background */
            color: white; /* White text for contrast */
            padding: 10px 20px; /* Make them a bit larger */
            border-radius: 5px;
            cursor: pointer;
            width: 90%; /* Match input width */
            margin-top: 15px; /* Add some space above */
        }

        .ad-banner {
            position: fixed;
            top: 0;
            bottom: 0;
            width: 160px; /* Ширина баннера */
            background-color: #f1f1f1;
            border: 1px solid #dcdcdc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #555;
            z-index: 500; /* Ниже чем меню, но выше фона */
        }
        #left-ad-banner {
            left: 0;
        }
        #right-ad-banner {
            right: 0;
        }
    </style>
</head>
<body>
    <div id="left-ad-banner" class="ad-banner">Your Ad Here</div>
    <div id="right-ad-banner" class="ad-banner">Your Ad Here</div>
    <div id="emoji-background"></div>
    <div id="main-content">
        <div id="auth-container"></div>
        <h1 id="main-title" style="font-size: 12em; color: crimson; text-align: center; margin-bottom: 20px; margin-top: 0;">MIGAgames</h1>
        <p style="text-align: center;"><span id="total-wins-display" style="font-size: 3.6em; color: #007bff;">Total Wins: 0</span></p>

             <div class="button-container">
                <button id="rps-button"></button>
                <button id="gtn-button"></button>
                <button id="donate-button"></button>
                <button id="settings-button"></button>
             </div>
    </div>

         <!-- This is the menu that will appear -->
         <div id="rps-menu" class="game-menu">
            <button id="rps-back-button" class="back-button">&larr;</button>
            <p id="bot-label"></p>
            <div id="result-container">
                <p id="bot-choice-text" style="font-size: 20px; margin: 5px;">Choice: ?</p>
                <h2 id="result-text" style="font-size: 48px; margin: 10px;"></h2>
            </div>
            <button id="rock-btn"></button>
            <button id="paper-btn"></button>
            <button id="scissors-btn"></button>
            <p id="player-label" style="margin-top: 25px; margin-bottom: 0;"></p>
         </div>

         <!-- Guess the number menu -->
         <div id="gtn-menu" class="game-menu">
            <button id="gtn-back-button" class="back-button">&larr;</button>
            <h2 id="gtn-title"></h2>
            <div id="dice-icon-container">
                <p id="dice-icon">⚃</p>
            </div>
            <h2 id="gtn-result-text" style="font-size: 48px; margin: 10px;"></h2>
            <div id="gtn-choices">
                <!-- Кнопки будут добавлены через JS -->
            </div>
            <button id="play-again-btn" style="display: none;"></button>
         </div>

         <!-- Settings menu -->
         <div id="settings-menu" class="game-menu">
            <button id="settings-back-button" class="back-button">&larr;</button>
            <div id="settings-main-content">
                <h2 id="settings-title"></h2>
                <button id="language-menu-btn" style="margin-top: 20px;"></button>
                <button id="theme-menu-btn" style="margin-top: 20px;"></button>
                <button id="button-color-menu-btn" style="margin-top: 20px;"></button>
            </div>
            <div id="language-submenu" style="display: none;">
                <button id="language-submenu-back-btn" class="back-button">&larr;</button>
                <h2 id="language-menu-title"></h2>
                <!-- Language buttons will be added here via JS -->
            </div>
            <div id="theme-submenu" style="display: none;">
                <button id="theme-submenu-back-btn" class="back-button">&larr;</button>
                <h2 id="theme-menu-title"></h2>
                <div id="theme-buttons-container" style="margin-top: 15px;"></div>
                <!-- Language buttons will be added here via JS -->
            </div>
            <div id="button-color-submenu" style="display: none;">
                <button id="button-color-submenu-back-btn" class="back-button">&larr;</button>
                <h2 id="button-color-menu-title"></h2>
                <div id="button-color-buttons-container" style="margin-top: 15px;"></div>
            </div>
         </div>

        <!-- Welcome/Auth Overlay -->
        <div id="welcome-overlay">
            <div class="auth-form-container">
                <!-- This container will be filled by JavaScript -->
            </div>
        </div>

    <!-- HTML Templates for Auth Forms -->
    <template id="welcome-register-form-template">
        <div id="welcome-register-form">
            <h2 id="welcome-register-title"></h2>
            <input type="text" id="welcome-register-username" placeholder="Username">
            <input type="email" id="welcome-register-email" placeholder="Email">
            <input type="password" id="welcome-register-password" placeholder="Password">
            <button id="welcome-register-submit"></button>
            <p id="welcome-register-error" style="color: red; font-size: 14px;"></p>
            <span id="switch-to-login" class="auth-switch-link"></span>
        </div>
    </template>
    <template id="welcome-login-form-template">
        <div id="welcome-login-form">
            <h2 id="welcome-login-title"></h2>
            <input type="text" id="welcome-login-username" placeholder="Username">
            <input type="password" id="welcome-login-password" placeholder="Password">
            <button id="welcome-login-submit"></button>
            <p id="welcome-login-error" style="color: red; font-size: 14px;"></p>
            <span id="switch-to-register" class="auth-switch-link"></span>
        </div>
    </template>

    <!-- Donate Menu -->
    <div id="donate-menu" class="game-menu">
        <!-- Amount Selection View -->
        <div id="donate-amount-selection">
            <button id="donate-back-btn" class="back-button">&larr;</button>
            <h2 id="donate-title"></h2>
            <p id="donate-description" style="font-size: 16px; font-weight: normal;"></p>
            <div id="donate-options" style="margin-top: 20px;">
                <button class="donate-option-btn" data-amount="$0.50">$0.50</button>
                <button class="donate-option-btn" data-amount="€1 / $1">€1 / $1</button>
                <button class="donate-option-btn" data-amount="€3 / $3">€3 / $3</button>
            </div>
        </div>
        <!-- Payment Method Selection View (hidden by default) -->
        <div id="donate-payment-selection" style="display: none;">
            <button id="donate-payment-back-btn" class="back-button">&larr;</button>
            <h2 id="donate-payment-title"></h2>
            <button id="apple-pay-btn" style="background-color: black; color: white; margin-top: 25px; padding: 15px; width: 90%; border-radius: 10px;"></button>
            <button id="card-pay-btn" style="background-color: #007bff; color: white; margin-top: 15px; padding: 15px; width: 90%; border-radius: 10px;"></button>
            <p id="payment-info" style="font-size: 12px; font-weight: normal; margin-top: 15px;"></p>
        </div>
    </div>

    <script>
        // Get the button and the menu elements
        const rpsButton = document.getElementById('rps-button');
        const rpsMenu = document.getElementById('rps-menu');
        const rpsBackButton = document.getElementById('rps-back-button');

        const gtnButton = document.getElementById('gtn-button');
        const gtnMenu = document.getElementById('gtn-menu');
        const gtnBackButton = document.getElementById('gtn-back-button');

        const settingsButton = document.getElementById('settings-button');
        const settingsMenu = document.getElementById('settings-menu');
        const settingsBackButton = document.getElementById('settings-back-button');



        // Game elements
        const rockBtn = document.getElementById('rock-btn');
        const paperBtn = document.getElementById('paper-btn');
        const scissorsBtn = document.getElementById('scissors-btn');
        const botChoiceText = document.getElementById('bot-choice-text');
        const resultText = document.getElementById('result-text');
        const botLabel = document.getElementById('bot-label');
        const playerLabel = document.getElementById('player-label');

        // Guess The Number game elements
        const diceIcon = document.getElementById('dice-icon');
        const gtnResultText = document.getElementById('gtn-result-text');
        const gtnChoicesContainer = document.getElementById('gtn-choices');
        const playAgainBtn = document.getElementById('play-again-btn');
        const diceFaces = ['⚀', '⚁', '⚂', '⚃', '⚄', '⚅']; // 1 to 6
        let diceSpinInterval = null; // Для хранения интервала смены цифр
        const gtnTitle = document.getElementById('gtn-title');

        // Settings elements
        const settingsTitle = document.getElementById('settings-title');
        const languageMenuBtn = document.getElementById('language-menu-btn');
        const languageSubmenu = document.getElementById('language-submenu');
        const settingsMainContent = document.getElementById('settings-main-content');
        const languageSubmenuBackBtn = document.getElementById('language-submenu-back-btn');
        const languageMenuTitle = document.getElementById('language-menu-title');
        const themeMenuBtn = document.getElementById('theme-menu-btn');
        const themeSubmenu = document.getElementById('theme-submenu');
        const themeSubmenuBackBtn = document.getElementById('theme-submenu-back-btn');
        const themeMenuTitle = document.getElementById('theme-menu-title');
        const buttonColorMenuBtn = document.getElementById('button-color-menu-btn');
        const buttonColorSubmenu = document.getElementById('button-color-submenu');
        const buttonColorSubmenuBackBtn = document.getElementById('button-color-submenu-back-btn');
        const buttonColorMenuTitle = document.getElementById('button-color-menu-title');
        const donateButton = document.getElementById('donate-button');
        const donateMenu = document.getElementById('donate-menu');
        const donateBackBtn = document.getElementById('donate-back-btn');
        const donateAmountSelection = document.getElementById('donate-amount-selection');
        const donatePaymentSelection = document.getElementById('donate-payment-selection');
        const donatePaymentBackBtn = document.getElementById('donate-payment-back-btn');


        const authContainer = document.getElementById('auth-container');

        // Auth elements will be created dynamically or found when menus are open

        let totalWins = 0; // Общий счетчик побед
        let currentLanguage = 'en'; // Язык по умолчанию

        const translations = {
            en: {
                mainTitle: "MIGAgames",
                totalWinsPrefix: "Total Wins:",
                rpsButton: "Rock, Paper, Scissors",
                gtnButton: "Guess the number",
                settingsButton: "Settings",
                botLabel: "BOT 🤖",
                playerLabel: "PLAYER 🧑",
                choicePrefix: "Choice:",
                win: "WIN!",
                lose: "LOSE!",
                draw: "DRAW!",
                rock: "Rock",
                paper: "Paper",
                scissors: "Scissors",
                gtnTitle: "Guess the Number",
                playAgain: "Play again",
                settingsTitle: "Settings",
                languageButton: "Language",
                languageMenuTitle: "Select Language",
                themeButton: "Theme",
                themeMenuTitle: "Select Theme",
                buttonColorButton: "Button Color",
                buttonColorMenuTitle: "Select Button Color",
                login: "Login",
                register: "Continue",
                logout: "Logout",
                welcome: "Welcome",
                usernamePlaceholder: "Username",
                passwordPlaceholder: "Password",
                loginError: "Invalid username or password.",
                registerError: "Username already taken.",
                registerSuccess: "Registration successful! Please log in.",
                emailPlaceholder: "Email",
                switchToLogin: "Already have an account? Login",
                switchToRegister: "Don't have an account? Register",
                allFieldsRequired: "All fields are required.",
                donateButton: "Donate",
                donateTitle: "Support the Project",
                donateDescription: "Your support helps keep the games running. Thank you!",
                donatePaymentTitle: "Choose payment method",
                applePay: "Pay with Apple Pay",
                cardPay: "Pay with Bank Card",
                paymentInfo: "This is a demo. No real payment will be processed.",
            },
            ru: {
                mainTitle: "MIGAgames",
                totalWinsPrefix: "Всего побед:",
                rpsButton: "Камень, Ножницы, Бумага",
                gtnButton: "Угадай число",
                settingsButton: "Настройки",
                botLabel: "БОТ 🤖",
                playerLabel: "ИГРОК 🧑",
                choicePrefix: "Выбор:",
                win: "ПОБЕДА!",
                lose: "ПРОИГРЫШ!",
                draw: "НИЧЬЯ!",
                rock: "Камень",
                paper: "Бумага",
                scissors: "Ножницы",
                gtnTitle: "Угадай число",
                playAgain: "Сыграть снова",
                settingsTitle: "Настройки",
                languageButton: "Язык",
                languageMenuTitle: "Выберите язык",
                themeButton: "Тема",
                themeMenuTitle: "Выберите тему",
                buttonColorButton: "Цвет кнопок",
                buttonColorMenuTitle: "Выберите цвет кнопок",
                login: "Войти",
                register: "Продолжить",
                logout: "Выйти",
                welcome: "Добро пожаловать",
                usernamePlaceholder: "Имя пользователя",
                passwordPlaceholder: "Пароль",
                loginError: "Неверное имя пользователя или пароль.",
                registerError: "Имя пользователя уже занято.",
                registerSuccess: "Регистрация прошла успешно! Пожалуйста, войдите.",
                emailPlaceholder: "Электронная почта",
                switchToLogin: "Уже есть аккаунт? Войти",
                switchToRegister: "Нет аккаунта? Зарегистрироваться",
                allFieldsRequired: "Все поля обязательны для заполнения.",
                donateButton: "Пожертвовать",
                donateTitle: "Поддержать проект",
                donateDescription: "Ваша поддержка помогает играм развиваться. Спасибо!",
                donatePaymentTitle: "Выберите способ оплаты",
                applePay: "Оплатить через Apple Pay",
                cardPay: "Оплатить банковской картой",
                paymentInfo: "Это демонстрация. Реальный платёж не будет обработан.",
            },
            es: { // Spanish
                mainTitle: "MIGAgames",
                totalWinsPrefix: "Victorias totales:",
                rpsButton: "Piedra, Papel, Tijeras",
                gtnButton: "Adivina el número",
                settingsButton: "Ajustes",
                botLabel: "BOT 🤖",
                playerLabel: "JUGADOR 🧑",
                choicePrefix: "Elección:",
                win: "¡GANASTE!",
                lose: "¡PERDISTE!",
                draw: "¡EMPATE!",
                rock: "Piedra",
                paper: "Papel",
                scissors: "Tijeras",
                gtnTitle: "Adivina el número",
                playAgain: "Jugar de nuevo",
                settingsTitle: "Ajustes",
                languageButton: "Idioma",
                languageMenuTitle: "Seleccionar idioma",
                themeButton: "Tema",
                themeMenuTitle: "Seleccionar tema",
                buttonColorButton: "Color del botón",
                buttonColorMenuTitle: "Seleccionar color del botón",
                login: "Iniciar sesión",
                register: "Continuar",
                logout: "Cerrar sesión",
                welcome: "Bienvenido",
                usernamePlaceholder: "Nombre de usuario",
                passwordPlaceholder: "Contraseña",
                loginError: "Nombre de usuario o contraseña no válidos.",
                registerError: "El nombre de usuario ya existe.",
                registerSuccess: "¡Registro exitoso! Por favor, inicie sesión.",
                emailPlaceholder: "Correo electrónico",
                switchToLogin: "¿Ya tienes una cuenta? Iniciar sesión",
                switchToRegister: "¿No tienes una cuenta? Registrarse",
                allFieldsRequired: "Todos los campos son obligatorios.",
                donateButton: "Donar",
                donateTitle: "Apoyar el proyecto",
                donateDescription: "Tu apoyo ayuda a mantener los juegos en funcionamiento. ¡Gracias!",
                donatePaymentTitle: "Elige método de pago",
                applePay: "Pagar con Apple Pay",
                cardPay: "Pagar con tarjeta bancaria",
                paymentInfo: "Esto es una demostración. No se procesará ningún pago real.",
            },
            de: { // German
                mainTitle: "MIGAgames",
                totalWinsPrefix: "Gesamtsiege:",
                rpsButton: "Schere, Stein, Papier",
                gtnButton: "Errate die Zahl",
                settingsButton: "Einstellungen",
                botLabel: "BOT 🤖",
                playerLabel: "SPIELER 🧑",
                choicePrefix: "Wahl:",
                win: "GEWONNEN!",
                lose: "VERLOREN!",
                draw: "UNENTSCHIEDEN!",
                rock: "Stein",
                paper: "Papier",
                scissors: "Schere",
                gtnTitle: "Errate die Zahl",
                playAgain: "Nochmal spielen",
                settingsTitle: "Einstellungen",
                languageButton: "Sprache",
                languageMenuTitle: "Sprache auswählen",
                themeButton: "Thema",
                themeMenuTitle: "Thema auswählen",
                buttonColorButton: "Knopffarbe",
                buttonColorMenuTitle: "Knopffarbe auswählen",
                login: "Anmelden",
                register: "Weiter",
                logout: "Abmelden",
                welcome: "Willkommen",
                usernamePlaceholder: "Benutzername",
                passwordPlaceholder: "Passwort",
                loginError: "Ungültiger Benutzername oder Passwort.",
                registerError: "Benutzername bereits vergeben.",
                registerSuccess: "Registrierung erfolgreich! Bitte melden Sie sich an.",
                emailPlaceholder: "Email",
                switchToLogin: "Hast du schon ein Konto? Anmelden",
                switchToRegister: "Kein Konto? Registrieren",
                allFieldsRequired: "Alle Felder sind erforderlich.",
                donateButton: "Spenden",
                donateTitle: "Projekt unterstützen",
                donateDescription: "Deine Unterstützung hilft, die Spiele am Laufen zu halten. Danke!",
                donatePaymentTitle: "Zahlungsmethode wählen",
                applePay: "Mit Apple Pay bezahlen",
                cardPay: "Mit Bankkarte bezahlen",
                paymentInfo: "Dies ist eine Demo. Es wird keine echte Zahlung verarbeitet.",
            },
            fi: { // Finnish
                mainTitle: "MIGAgames",
                totalWinsPrefix: "Voitot yhteensä:",
                rpsButton: "Kivi, Paperi, Sakset",
                gtnButton: "Arvaa numero",
                settingsButton: "Asetukset",
                botLabel: "BOTTI 🤖",
                playerLabel: "PELAAJA 🧑",
                choicePrefix: "Valinta:",
                win: "VOITIT!",
                lose: "HÄVISIT!",
                draw: "TASAPELI!",
                rock: "Kivi",
                paper: "Paperi",
                scissors: "Sakset",
                gtnTitle: "Arvaa numero",
                playAgain: "Pelaa uudelleen",
                settingsTitle: "Asetukset",
                languageButton: "Kieli",
                languageMenuTitle: "Valitse kieli",
                themeButton: "Teema",
                themeMenuTitle: "Valitse teema",
                buttonColorButton: "Painikkeen väri",
                buttonColorMenuTitle: "Valitse painikkeen väri",
                login: "Kirjaudu sisään",
                register: "Jatka",
                logout: "Kirjaudu ulos",
                welcome: "Tervetuloa",
                usernamePlaceholder: "Käyttäjätunnus",
                passwordPlaceholder: "Salasana",
                loginError: "Virheellinen käyttäjätunnus tai salasana.",
                registerError: "Käyttäjätunnus on jo varattu.",
                registerSuccess: "Rekisteröinti onnistui! Kirjaudu sisään.",
                emailPlaceholder: "Sähköposti",
                switchToLogin: "Onko sinulla jo tili? Kirjaudu sisään",
                switchToRegister: "Eikö sinulla ole tiliä? Rekisteröidy",
                allFieldsRequired: "Kaikki kentät ovat pakollisia.",
                donateButton: "Lahjoita",
                donateTitle: "Tue projektia",
                donateDescription: "Tukesi auttaa pitämään pelit käynnissä. Kiitos!",
                donatePaymentTitle: "Valitse maksutapa",
                applePay: "Maksa Apple Paylla",
                cardPay: "Maksa pankkikortilla",
                paymentInfo: "Tämä on demo. Oikeaa maksua ei käsitellä.",
            },
            zh: { // Chinese
                mainTitle: "MIGAgames",
                totalWinsPrefix: "总胜利:",
                rpsButton: "石头,剪刀,布",
                gtnButton: "猜数字",
                settingsButton: "设置",
                botLabel: "机器人 🤖",
                playerLabel: "玩家 🧑",
                choicePrefix: "选择:",
                win: "胜利!",
                lose: "失败!",
                draw: "平局!",
                rock: "石头",
                paper: "布",
                scissors: "剪刀",
                gtnTitle: "猜数字",
                playAgain: "再玩一次",
                settingsTitle: "设置",
                languageButton: "语言",
                languageMenuTitle: "选择语言",
                themeButton: "主题",
                themeMenuTitle: "选择主题",
                buttonColorButton: "按钮颜色",
                buttonColorMenuTitle: "选择按钮颜色",
                login: "登录",
                register: "继续",
                logout: "登出",
                welcome: "欢迎",
                usernamePlaceholder: "用户名",
                passwordPlaceholder: "密码",
                loginError: "无效的用户名或密码。",
                registerError: "用户名已被占用。",
                registerSuccess: "注册成功！请登录。",
                emailPlaceholder: "电子邮件",
                switchToLogin: "已有账户？登录",
                switchToRegister: "没有账户？注册",
                allFieldsRequired: "所有字段都是必填项。",
                donateButton: "捐赠",
                donateTitle: "支持项目",
                donateDescription: "您的支持有助于保持游戏运行。谢谢！",
                donatePaymentTitle: "选择付款方式",
                applePay: "使用 Apple Pay 付款",
                cardPay: "使用银行卡付款",
                paymentInfo: "这是一个演示。不会处理任何实际付款。",
            },
            uk: { // Ukrainian
                mainTitle: "MIGAgames",
                totalWinsPrefix: "Всього перемог:",
                rpsButton: "Камінь, Ножиці, Папір",
                gtnButton: "Вгадай число",
                settingsButton: "Налаштування",
                botLabel: "БОТ 🤖",
                playerLabel: "ГРАВЕЦЬ 🧑",
                choicePrefix: "Вибір:",
                win: "ПЕРЕМОГА!",
                lose: "ПРОГРАШ!",
                draw: "НІЧИЯ!",
                rock: "Камінь",
                paper: "Папір",
                scissors: "Ножиці",
                gtnTitle: "Вгадай число",
                playAgain: "Зіграти знову",
                settingsTitle: "Налаштування",
                languageButton: "Мова",
                languageMenuTitle: "Вибрати мову",
                themeButton: "Тема",
                themeMenuTitle: "Вибрати тему",
                buttonColorButton: "Колір кнопок",
                buttonColorMenuTitle: "Вибрати колір кнопок",
                login: "Увійти",
                register: "Продовжити",
                logout: "Вийти",
                welcome: "Ласкаво просимо",
                usernamePlaceholder: "Ім'я користувача",
                passwordPlaceholder: "Пароль",
                loginError: "Неправильне ім'я користувача або пароль.",
                registerError: "Ім'я користувача вже зайняте.",
                registerSuccess: "Реєстрація успішна! Будь ласка, увійдіть.",
                emailPlaceholder: "Електронна пошта",
                switchToLogin: "Вже є аккаунт? Увійти",
                switchToRegister: "Немає аккаунта? Зареєструватися",
                allFieldsRequired: "Усі поля обов'язкові.",
                donateButton: "Пожертвувати",
                donateTitle: "Підтримати проект",
                donateDescription: "Ваша підтримка допомагає іграм розвиватися. Дякуємо!",
                donatePaymentTitle: "Виберіть спосіб оплати",
                applePay: "Сплатити через Apple Pay",
                cardPay: "Сплатити банківською карткою",
                paymentInfo: "Це демонстрація. Справжній платіж не буде оброблено.",
            },
            pt: { // Portuguese
                mainTitle: "MIGAgames",
                totalWinsPrefix: "Total de vitórias:",
                rpsButton: "Pedra, Papel, Tesoura",
                gtnButton: "Adivinhe o número",
                settingsButton: "Configurações",
                botLabel: "BOT 🤖",
                playerLabel: "JOGADOR 🧑",
                choicePrefix: "Escolha:",
                win: "VENCEU!",
                lose: "PERDEU!",
                draw: "EMPATE!",
                rock: "Pedra",
                paper: "Papel",
                scissors: "Tesoura",
                gtnTitle: "Adivinhe o número",
                playAgain: "Jogar novamente",
                settingsTitle: "Configurações",
                languageButton: "Idioma",
                languageMenuTitle: "Selecione o idioma",
                themeButton: "Tema",
                themeMenuTitle: "Selecione o tema",
                buttonColorButton: "Cor do botão",
                buttonColorMenuTitle: "Selecione a cor do botão",
                login: "Entrar",
                register: "Continuar",
                logout: "Sair",
                welcome: "Bem-vindo",
                usernamePlaceholder: "Nome de usuário",
                passwordPlaceholder: "Senha",
                loginError: "Nome de usuário ou senha inválidos.",
                registerError: "Nome de usuário já existe.",
                registerSuccess: "Registro bem-sucedido! Por favor, faça o login.",
                emailPlaceholder: "Email",
                switchToLogin: "Já tem uma conta? Entrar",
                switchToRegister: "Não tem uma conta? Registrar",
                allFieldsRequired: "Todos os campos são obrigatórios.",
                donateButton: "Doar",
                donateTitle: "Apoie o Projeto",
                donateDescription: "Seu apoio ajuda a manter os jogos funcionando. Obrigado!",
                donatePaymentTitle: "Escolha a forma de pagamento",
                applePay: "Pagar com Apple Pay",
                cardPay: "Pagar com cartão bancário",
                paymentInfo: "Isto é uma demonstração. Nenhum pagamento real será processado.",
            },
        };

        const choices = ['Rock', 'Paper', 'Scissors'];

        function closeAllMenus() {
            rpsMenu.style.display = 'none';
            gtnMenu.style.display = 'none';
            settingsMenu.style.display = 'none';
            donateMenu.style.display = 'none';
            buttonColorSubmenu.style.display = 'none';
            themeSubmenu.style.display = 'none';
        }
        
        function applyLanguage(lang) {
            currentLanguage = lang;
            const t = translations[lang];

            // Main page elements
            document.getElementById('main-title').textContent = t.mainTitle;
            document.getElementById('rps-button').textContent = t.rpsButton;
            document.getElementById('gtn-button').textContent = t.gtnButton;
            document.getElementById('donate-button').textContent = t.donateButton;
            document.getElementById('settings-button').textContent = t.settingsButton; // This line was missing a semicolon in the previous context, but it's not the cause of the issue. The main issue is the initial HTML content.

            // RPS Menu elements
            botLabel.textContent = t.botLabel;
            playerLabel.textContent = t.playerLabel;
            rockBtn.textContent = t.rock;
            paperBtn.textContent = t.paper;
            scissorsBtn.textContent = t.scissors;

            // GTN Menu elements
            gtnTitle.textContent = t.gtnTitle;
            playAgainBtn.textContent = t.playAgain;

            // Settings Menu elements
            settingsTitle.textContent = t.settingsTitle;
            languageMenuBtn.textContent = t.languageButton;
            languageMenuTitle.textContent = t.languageMenuTitle;
            themeMenuBtn.textContent = t.themeButton;
            themeMenuTitle.textContent = t.themeMenuTitle;
            buttonColorMenuBtn.textContent = t.buttonColorButton;
            buttonColorMenuTitle.textContent = t.buttonColorMenuTitle;

            // Donate Menu
            document.getElementById('donate-title').textContent = t.donateTitle;
            document.getElementById('donate-description').textContent = t.donateDescription;
            document.getElementById('donate-payment-title').textContent = t.donatePaymentTitle;
            document.getElementById('apple-pay-btn').textContent = t.applePay;
            document.getElementById('card-pay-btn').textContent = t.cardPay;
            document.getElementById('payment-info').textContent = t.paymentInfo;
            
            // Auth UI
            updateAuthUI();

            // Translate open menus

            updateTotalWinsDisplay(); // Обновляем отображение счета с новым префиксом
        }

        function updateTotalWinsDisplay() {
            document.getElementById('total-wins-display').textContent = `${translations[currentLanguage].totalWinsPrefix} ${totalWins}`; // This line was also missing a semicolon.
        }



        // Add a click event listener to the button
        rpsButton.addEventListener('click', function() {
            closeAllMenus(); // Сначала закрываем все меню
            // When the button is clicked, show the menu
            rpsMenu.style.display = 'block';

        });

        // Add a click event listener to the back button
        rpsBackButton.addEventListener('click', function() {
            // When the back button is clicked, hide the menu
            rpsMenu.style.display = 'none';
        });

        // Add a click event listener to the GTN button
        gtnButton.addEventListener('click', function() {
            closeAllMenus();
            startGtnGame();
            gtnMenu.style.display = 'block';
        });

        // Add a click event listener to the GTN back button
        gtnBackButton.addEventListener('click', function() {
            gtnMenu.style.display = 'none';
        });

        // Add a click event listener to the Settings button
        settingsButton.addEventListener('click', function() {
            closeAllMenus();
            settingsMainContent.style.display = 'block';
            languageSubmenu.style.display = 'none';
            themeSubmenu.style.display = 'none';
            languageSubmenu.style.display = 'none';
            settingsMenu.style.display = 'block';
        });

        // Add a click event listener to the Settings back button
        settingsBackButton.addEventListener('click', function() {
            settingsMenu.style.display = 'none';
        });

        // Add a click event listener to the Donate button
        donateButton.addEventListener('click', function() {
            closeAllMenus();
            donateAmountSelection.style.display = 'block';
            donatePaymentSelection.style.display = 'none';
            donateMenu.style.display = 'block';
        });

        donateBackBtn.addEventListener('click', function() {
            donateMenu.style.display = 'none';
        });

        // Game logic
        function playGame(playerChoice) {
            // Bot makes a random choice
            const botChoice = choices[Math.floor(Math.random() * choices.length)]; // Choices are still in English for internal logic
            botChoiceText.textContent = `${translations[currentLanguage].choicePrefix} ${translations[currentLanguage][botChoice.toLowerCase()]}`;

            // Determine the winner
            if (playerChoice === botChoice) {
                resultText.textContent = translations[currentLanguage].draw;
                resultText.style.color = 'gray';
            } else if (
                (playerChoice === 'Rock' && botChoice === 'Scissors') ||
                (playerChoice === 'Paper' && botChoice === 'Rock') ||
                (playerChoice === 'Scissors' && botChoice === 'Paper')
            ) {
                resultText.textContent = translations[currentLanguage].win;
                resultText.style.color = 'green';
                totalWins++; // Увеличиваем общий счетчик побед
            } else {
                resultText.textContent = translations[currentLanguage].lose;
                resultText.style.color = 'red';
            }

            // Сбросить результат через 6 секунд (6000 миллисекунд)
            setTimeout(function() {
                resultText.textContent = '';
                botChoiceText.textContent = `${translations[currentLanguage].choicePrefix} ?`;
                updateTotalWinsDisplay(); // Обновляем отображение счета после сброса
            }, 6000);
        }

        // Add event listeners to player's choice buttons
        rockBtn.addEventListener('click', function() {
            playGame('Rock');
        });
        paperBtn.addEventListener('click', function() {
            playGame('Paper');
        });
        scissorsBtn.addEventListener('click', function() {
            playGame('Scissors');
        });

        // --- Guess The Number Logic ---

        function startGtnGame() {
            // 1. Reset state
            gtnResultText.textContent = '';
            playAgainBtn.style.display = 'none';
            gtnChoicesContainer.style.display = 'block';
            gtnChoicesContainer.innerHTML = ''; // Clear old buttons

            // 2. Start spinning
            if (diceSpinInterval) clearInterval(diceSpinInterval); // Очищаем старый интервал, если он есть
            diceIcon.classList.add('spinning');
            diceSpinInterval = setInterval(() => {
                // Показываем случайную грань кости каждые 100мс
                const randomFace = diceFaces[Math.floor(Math.random() * diceFaces.length)];
                diceIcon.textContent = randomFace;
            }, 100);

            // 3. Create number buttons
            for (let i = 1; i <= 6; i++) {
                const button = document.createElement('button');
                button.textContent = i;
                button.addEventListener('click', () => handleGtnChoice(i));
                gtnChoicesContainer.appendChild(button);
            }
        }

        function handleGtnChoice(playerGuess) {
            // 1. Stop spinning
            clearInterval(diceSpinInterval); // Останавливаем смену цифр
            diceIcon.classList.remove('spinning'); // Останавливаем CSS-вращение

            // 2. Get random dice result (number from 1 to 6)
            const diceResult = Math.floor(Math.random() * 6) + 1;

            // 3. Update dice icon to show result
            diceIcon.textContent = diceFaces[diceResult - 1];

            // 4. Check for win/loss
            if (playerGuess === diceResult) {
                gtnResultText.textContent = translations[currentLanguage].win;
                gtnResultText.style.color = 'green';
                totalWins++; // Увеличиваем общий счетчик побед
            } else {
                gtnResultText.textContent = translations[currentLanguage].lose;
                gtnResultText.style.color = 'red';
            }

            // 5. Hide choice buttons and show "Play again" button
            gtnChoicesContainer.style.display = 'none';
            playAgainBtn.style.display = 'inline-block';
            updateTotalWinsDisplay(); // Обновляем отображение счета
        }

        // Event listener for "Play again" button
        playAgainBtn.addEventListener('click', startGtnGame);

        // --- Settings Logic ---
        languageMenuBtn.addEventListener('click', () => {
            settingsMainContent.style.display = 'none';
            languageSubmenu.style.display = 'block';
        });

        languageSubmenuBackBtn.addEventListener('click', () => {
            languageSubmenu.style.display = 'none';
            settingsMainContent.style.display = 'block';
        });

        themeMenuBtn.addEventListener('click', () => {
            settingsMainContent.style.display = 'none';
            themeSubmenu.style.display = 'block';
        });

        themeSubmenuBackBtn.addEventListener('click', () => {
            themeSubmenu.style.display = 'none';
            settingsMainContent.style.display = 'block';
        });

        buttonColorMenuBtn.addEventListener('click', () => {
            settingsMainContent.style.display = 'none';
            buttonColorSubmenu.style.display = 'block';
        });

        buttonColorSubmenuBackBtn.addEventListener('click', () => {
            buttonColorSubmenu.style.display = 'none';
            settingsMainContent.style.display = 'block';
        });

        function createThemeButtons() {
            const themeContainer = document.getElementById('theme-buttons-container');
            const themes = {
                'Red': 'red',
                'Yellow': 'yellow',
                'Green': 'green',
                'Orange': 'orange',
                'Purple': 'purple',
                'White': 'white'
            };

            Object.keys(themes).forEach(themeName => {
                const button = document.createElement('button');
                button.textContent = themeName;
                button.style.backgroundColor = themes[themeName];
                if (themeName === 'White' || themeName === 'Yellow') {
                    button.style.color = 'black'; // Make text visible on light backgrounds
                } else {
                    button.style.color = 'white'; // Make text visible on dark backgrounds
                }
                button.addEventListener('click', () => {
                    document.body.style.backgroundColor = themes[themeName];
                });
                themeContainer.appendChild(button);
            });
        }

        function createButtonColorButtons() {
            const container = document.getElementById('button-color-buttons-container');
            const colors = {
                'Black': 'black',
                'Pink': 'hotpink',
                'Dark Blue': 'darkblue'
            };

            Object.keys(colors).forEach(colorName => {
                const button = document.createElement('button');
                button.textContent = colorName;
                button.style.backgroundColor = colors[colorName];
                button.style.color = 'white'; // Default to white text

                button.addEventListener('click', () => {
                    const allButtons = document.querySelectorAll('button');
                    allButtons.forEach(btn => {
                        // We don't want to change the style of the back buttons or theme buttons
                        if (!btn.classList.contains('back-button') && !btn.parentElement.id.includes('theme-buttons') && !btn.parentElement.id.includes('button-color-buttons')) {
                            btn.style.backgroundColor = colors[colorName];
                            btn.style.color = 'white'; // Keep text white for all these colors
                        }
                    });
                });
                container.appendChild(button);
            });
        }

        function createLanguageButtons() {
            const langContainer = document.getElementById('language-submenu');
            const langCodes = { 'English': 'en', 'Русский': 'ru', 'Español': 'es', 'Deutsch': 'de', 'Suomi': 'fi', '中文': 'zh', 'Українська': 'uk', 'Português': 'pt' };
            
            Object.keys(langCodes).forEach(langName => {
                const button = document.createElement('button');
                button.textContent = langName;
                button.addEventListener('click', () => {
                    applyLanguage(langCodes[langName]);
                });
                langContainer.appendChild(button);
            });
        }

        function createBackgroundEmojis() {
            const emojiContainer = document.getElementById('emoji-background');
            if (!emojiContainer) return;
            const emojis = ['✂️', '🗿', '🎰', '🎲', '⚙️'];
            const numberOfEmojis = 50;

            for (let i = 0; i < numberOfEmojis; i++) {
                const emojiSpan = document.createElement('span');
                
                emojiSpan.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                emojiSpan.style.left = Math.random() * 100 + 'vw';
                emojiSpan.style.top = Math.random() * 100 + 'vh';
                emojiSpan.style.fontSize = (Math.random() * 2.5 + 1) + 'em'; // от 1em до 3.5em
                emojiSpan.style.opacity = Math.random() * 0.4 + 0.1; // от 0.1 до 0.5
                emojiSpan.style.animationDelay = Math.random() * 10 + 's';
                emojiSpan.style.animationDuration = (Math.random() * 10 + 8) + 's'; // от 8 до 18 секунд

                emojiContainer.appendChild(emojiSpan);
            }
        }

        // --- AUTH LOGIC ---
        function updateAuthUI() {
            const currentUser = localStorage.getItem('currentUser');
            authContainer.innerHTML = ''; // Clear previous state
            
            if (currentUser) {
                // Logged in state
                document.getElementById('main-content').style.display = 'block';
                document.getElementById('welcome-overlay').style.display = 'none';
                const t = translations[currentLanguage];
                const welcomeText = document.createElement('span');
                welcomeText.textContent = `${t.welcome}, ${currentUser}! `;
                welcomeText.style.color = document.body.style.backgroundColor === 'white' ? 'black' : 'white';

                const logoutBtn = document.createElement('button');
                logoutBtn.id = 'logout-btn';
                logoutBtn.textContent = t.logout;
                logoutBtn.addEventListener('click', handleLogout);

                authContainer.appendChild(welcomeText);
                authContainer.appendChild(logoutBtn);
            } else {
                // Logged out state
                document.getElementById('main-content').style.display = 'none';
                document.getElementById('welcome-overlay').style.display = 'flex';
            }
        }

        function handleLogout() {
            saveUserWins(); // Save wins before logging out
            localStorage.removeItem('currentUser');
            totalWins = 0; // Reset wins for logged-out state
            updateAuthUI();
            updateTotalWinsDisplay();
        }

        function handleLogin(e) {
            const username = document.getElementById('welcome-login-username').value;
            const password = document.getElementById('welcome-login-password').value;
            const users = JSON.parse(localStorage.getItem('users')) || [];
            
            const user = users.find(u => u.username === username && u.password === password);

            if (user) {
                localStorage.setItem('currentUser', user.username);
                totalWins = user.wins || 0;
                updateAuthUI();
                updateTotalWinsDisplay();
            } else {
                document.getElementById('welcome-login-error').textContent = translations[currentLanguage].loginError;
            }
        }

        function handleRegister(e) {
            const username = document.getElementById('welcome-register-username').value;
            const password = document.getElementById('welcome-register-password').value;
            const email = document.getElementById('welcome-register-email').value;
            let users = JSON.parse(localStorage.getItem('users')) || [];

            if (!username || !password || !email) {
                document.getElementById('welcome-register-error').textContent = translations[currentLanguage].allFieldsRequired;
                return;
            }

            if (users.some(u => u.username === username)) {
                document.getElementById('welcome-register-error').textContent = translations[currentLanguage].registerError;
            } else {
                users.push({ username, password, email, wins: 0 });
                localStorage.setItem('users', JSON.stringify(users));
                
                const errorP = document.getElementById('welcome-register-error');
                errorP.textContent = translations[currentLanguage].registerSuccess;
                errorP.style.color = 'green';

                setTimeout(() => {
                    localStorage.setItem('currentUser', username);
                    totalWins = 0;
                    updateAuthUI();
                    updateTotalWinsDisplay();
                }, 1500);
            }
        }

        function saveUserWins() {
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                let users = JSON.parse(localStorage.getItem('users')) || [];
                const userIndex = users.findIndex(u => u.username === currentUser);
                if (userIndex !== -1) {
                    users[userIndex].wins = totalWins;
                    localStorage.setItem('users', JSON.stringify(users));
                }
            }
        }

        function showRegisterForm() {
            const container = document.querySelector('.auth-form-container');
            const template = document.getElementById('welcome-register-form-template');
            container.innerHTML = template.innerHTML;
            translateRegisterForm(translations[currentLanguage]);
            document.getElementById('welcome-register-submit').addEventListener('click', handleRegister);
            document.getElementById('switch-to-login').addEventListener('click', showLoginForm);
        }

        function showLoginForm() {
            const container = document.querySelector('.auth-form-container');
            const template = document.getElementById('welcome-login-form-template');
            container.innerHTML = template.innerHTML;
            translateLoginForm(translations[currentLanguage]);
            document.getElementById('welcome-login-submit').addEventListener('click', handleLogin);
            document.getElementById('switch-to-register').addEventListener('click', showRegisterForm);
        }

        function translateRegisterForm(t) {
            document.getElementById('welcome-register-title').textContent = t.register;
            document.getElementById('welcome-register-username').placeholder = t.usernamePlaceholder;
            document.getElementById('welcome-register-email').placeholder = t.emailPlaceholder;
            document.getElementById('welcome-register-password').placeholder = t.passwordPlaceholder;
            document.getElementById('welcome-register-submit').textContent = t.register;
            document.getElementById('switch-to-login').textContent = t.switchToLogin;
        }

        function translateLoginForm(t) {
            document.getElementById('welcome-login-title').textContent = t.login;
            document.getElementById('welcome-login-username').placeholder = t.usernamePlaceholder;
            document.getElementById('welcome-login-password').placeholder = t.passwordPlaceholder;
            document.getElementById('welcome-login-submit').textContent = t.login;
            document.getElementById('switch-to-register').textContent = t.switchToRegister;
        }
        
        window.addEventListener('beforeunload', saveUserWins);

        // Initial language application
        function initialize() {
            createLanguageButtons();
            createButtonColorButtons();
            createThemeButtons();
            createBackgroundEmojis();
            if (!localStorage.getItem('currentUser')) {
                showRegisterForm();
            }
            applyLanguage(currentLanguage);
            updateAuthUI();
            updateTotalWinsDisplay();
        }

        initialize();


    </script>
</body>
</html>